---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  return [
    { params: { category: "blog" } },
    { params: { category: "diary" } },
  ];
}

const { category } = Astro.params;

const posts = (await getCollection("posts"))
  .filter((post) => post.data.category === category)
  .sort(
    (a, b) =>
      new Date(b.data.published_date).getTime() -
      new Date(a.data.published_date).getTime()
  );
---

<BaseLayout>
  <h1>Category: {category}</h1>

  <ul>
    {posts.map((post) => (
      <li>
        <a href={`/${post.slug}`}>
          {post.data.title}
        </a>
      </li>
    ))}
  </ul>
</BaseLayout>
